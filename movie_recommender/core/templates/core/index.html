{% extends 'core/base.html' %}

{% block content %}
<div class="mb-10 text-center">
    {% if search_query %}
    <h2
        class="text-3xl font-bold mb-2 text-[#fbbf24] ancient-font/tracking-widest drop-shadow-[0_2px_4px_rgba(0,0,0,0.8)]">
        Search Results for "{{ search_query }}"</h2>
    <a href="{% url 'index' %}"
        class="text-[#b45309] hover:text-[#fbbf24] transition border-b border-[#b45309] hover:border-[#fbbf24] pb-1">‚Üê
        Return to the Vault</a>
    {% else %}
    <h2
        class="text-4xl font-bold mb-2 text-[#fbbf24] ancient-font drop-shadow-[0_2px_4px_rgba(0,0,0,0.8)] tracking-widest">
        Treasures of the Cinema</h2>
    <p class="text-[#a8a29e] italic font-serif">Handpicked treasures for your journey</p>
    {% endif %}
</div>

<div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-8">
    {% for movie in movies %}
    <a href="{% url 'movie_detail' movie.tmdb_id %}"
        class="group bg-[#1c1917] rounded rounded-t-lg overflow-hidden shadow-[0_10px_30px_rgba(0,0,0,0.5)] border-2 border-[#44403c] hover:border-[#fbbf24] transition-all duration-300 transform hover:-translate-y-2 hover:shadow-[0_0_20px_rgba(251,191,36,0.3)] relative">

        <!-- Golden Corner Accents -->
        <div
            class="absolute top-0 left-0 w-8 h-8 border-t-2 border-l-2 border-[#b45309] opacity-50 group-hover:opacity-100 transition-opacity z-10">
        </div>
        <div
            class="absolute top-0 right-0 w-8 h-8 border-t-2 border-r-2 border-[#b45309] opacity-50 group-hover:opacity-100 transition-opacity z-10">
        </div>
        <div
            class="absolute bottom-0 left-0 w-8 h-8 border-b-2 border-l-2 border-[#b45309] opacity-50 group-hover:opacity-100 transition-opacity z-10">
        </div>
        <div
            class="absolute bottom-0 right-0 w-8 h-8 border-b-2 border-r-2 border-[#b45309] opacity-50 group-hover:opacity-100 transition-opacity z-10">
        </div>

        <div class="relative aspect-[2/3] poster-placeholder bg-[#0f291e]">
            <img class="fetch-poster w-full h-full object-cover opacity-0 transition-opacity duration-700 grayscale-[30%] group-hover:grayscale-0"
                data-tmdb-id="{{ movie.tmdb_id }}" alt="{{ movie.title }}"
                src="https://via.placeholder.com/500x750?text={{ movie.title|urlencode }}">

            <!-- Overlay Gradient -->
            <div class="absolute inset-0 bg-gradient-to-t from-[#1c1917] via-transparent to-transparent opacity-90">
            </div>
        </div>

        <div class="p-4 relative bg-[#1c1917] border-t border-[#44403c]">
            <h3 class="font-bold text-lg truncate text-[#e7e5e4] group-hover:text-[#fbbf24] transition ancient-font tracking-wide"
                title="{{ movie.title }}">
                {{ movie.title }}
            </h3>
            <div class="flex justify-between items-center text-xs text-[#a8a29e] mt-2 font-serif">
                <span>{{ movie.release_date|date:"Y" }}</span>
                <span class="text-[#fbbf24] flex items-center gap-1">
                    <svg class="w-3 h-3 fill-current" viewBox="0 0 20 20">
                        <path
                            d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                    </svg>
                    {{ movie.vote_average }}
                </span>
            </div>
        </div>
    </a>
    {% empty %}
    <p
        class="col-span-full text-center text-[#a8a29e] py-10 italic font-serif text-xl border-2 border-dashed border-[#44403c] rounded-xl bg-[#1c1917] p-8">
        The ancient scrolls contain no such records. Seek another path.
    </p>
    {% endfor %}
</div>
{% endblock %}